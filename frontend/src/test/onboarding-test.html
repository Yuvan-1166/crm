<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding Form Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-sky-100 via-blue-50 to-cyan-100 min-h-screen">
    <div class="container mx-auto p-8">
        <h1 class="text-3xl font-bold text-center mb-8">CRM Onboarding Form Test</h1>
        
        <!-- Test Checklist -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">Testing Checklist</h2>
            <div class="space-y-2">
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span>Backend server running on port 3000</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span>Frontend server running on port 5174</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span>Database has department field in employees table</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span>Google OAuth Client ID configured</span>
                </label>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span>Environment variables set up</span>
                </label>
            </div>
        </div>

        <!-- Test Scenarios -->
        <div class="grid md:grid-cols-2 gap-6">
            <!-- Scenario 1 -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-3 text-green-600">✅ Scenario 1: New User</h3>
                <div class="space-y-2 text-sm">
                    <p><strong>Given:</strong> User has never logged in</p>
                    <p><strong>When:</strong> User completes Google OAuth</p>
                    <p><strong>Then:</strong> Redirected to onboarding form</p>
                    <p><strong>And:</strong> Must complete profile to access dashboard</p>
                </div>
                <button onclick="testScenario1()" class="mt-4 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                    Test This Scenario
                </button>
            </div>

            <!-- Scenario 2 -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-3 text-blue-600">✅ Scenario 2: Complete Profile</h3>
                <div class="space-y-2 text-sm">
                    <p><strong>Given:</strong> User has complete profile</p>
                    <p><strong>When:</strong> User logs in with Google</p>
                    <p><strong>Then:</strong> Redirected directly to dashboard</p>
                    <p><strong>And:</strong> No onboarding form shown</p>
                </div>
                <button onclick="testScenario2()" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    Test This Scenario
                </button>
            </div>

            <!-- Scenario 3 -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-3 text-yellow-600">⚠️ Scenario 3: Incomplete Profile</h3>
                <div class="space-y-2 text-sm">
                    <p><strong>Given:</strong> User missing phone or department</p>
                    <p><strong>When:</strong> User logs in with Google</p>
                    <p><strong>Then:</strong> Redirected to onboarding form</p>
                    <p><strong>And:</strong> Must complete missing information</p>
                </div>
                <button onclick="testScenario3()" class="mt-4 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600">
                    Test This Scenario
                </button>
            </div>

            <!-- Scenario 4 -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-3 text-red-600">❌ Scenario 4: Form Validation</h3>
                <div class="space-y-2 text-sm">
                    <p><strong>Given:</strong> User on onboarding form</p>
                    <p><strong>When:</strong> User submits invalid data</p>
                    <p><strong>Then:</strong> Validation errors shown</p>
                    <p><strong>And:</strong> Form doesn't submit until valid</p>
                </div>
                <button onclick="testScenario4()" class="mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                    Test This Scenario
                </button>
            </div>
        </div>

        <!-- Quick Links -->
        <div class="bg-white rounded-lg shadow-lg p-6 mt-8">
            <h2 class="text-xl font-semibold mb-4">Quick Links</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <a href="http://localhost:5174" target="_blank" 
                   class="bg-sky-500 text-white px-4 py-2 rounded text-center hover:bg-sky-600">
                    Frontend App
                </a>
                <a href="http://localhost:5174/login" target="_blank" 
                   class="bg-blue-500 text-white px-4 py-2 rounded text-center hover:bg-blue-600">
                    Login Page
                </a>
                <a href="http://localhost:5174/onboarding" target="_blank" 
                   class="bg-green-500 text-white px-4 py-2 rounded text-center hover:bg-green-600">
                    Onboarding Page
                </a>
            </div>
        </div>

        <!-- API Test -->
        <div class="bg-white rounded-lg shadow-lg p-6 mt-8">
            <h2 class="text-xl font-semibold mb-4">API Test</h2>
            <button onclick="testAPI()" class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600">
                Test Backend API
            </button>
            <div id="api-result" class="mt-4 p-4 bg-gray-100 rounded hidden">
                <pre id="api-output"></pre>
            </div>
        </div>
    </div>

    <script>
        function testScenario1() {
            alert('Test Scenario 1:\n\n1. Go to http://localhost:5174\n2. Click "Continue with Google"\n3. Complete Google OAuth\n4. Should redirect to /onboarding\n5. Complete the 2-step form\n6. Should redirect to /dashboard');
            window.open('http://localhost:5174', '_blank');
        }

        function testScenario2() {
            alert('Test Scenario 2:\n\n1. Complete Scenario 1 first\n2. Logout from dashboard\n3. Login again with same Google account\n4. Should redirect directly to /dashboard\n5. No onboarding form should appear');
            window.open('http://localhost:5174/login', '_blank');
        }

        function testScenario3() {
            alert('Test Scenario 3:\n\n1. Manually remove phone or department from database\n2. Login with Google OAuth\n3. Should redirect to /onboarding\n4. Complete missing information\n5. Should redirect to /dashboard');
            window.open('http://localhost:5174/login', '_blank');
        }

        function testScenario4() {
            alert('Test Scenario 4:\n\n1. Go to onboarding form\n2. Try submitting without phone number\n3. Try invalid phone format\n4. Try submitting without department\n5. Verify validation errors appear');
            window.open('http://localhost:5174/onboarding', '_blank');
        }

        async function testAPI() {
            const resultDiv = document.getElementById('api-result');
            const outputPre = document.getElementById('api-output');
            
            resultDiv.classList.remove('hidden');
            outputPre.textContent = 'Testing API...';

            try {
                // Test backend health
                const response = await fetch('http://localhost:3000/api/health');
                const data = await response.json();
                
                outputPre.textContent = JSON.stringify({
                    status: response.status,
                    data: data,
                    message: 'Backend API is responding!'
                }, null, 2);
                
            } catch (error) {
                outputPre.textContent = JSON.stringify({
                    error: error.message,
                    message: 'Backend API is not responding. Make sure the server is running on port 3000.'
                }, null, 2);
            }
        }
    </script>
</body>
</html>